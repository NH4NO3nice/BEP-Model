!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!时间平滑!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    
MODULE module_time_smooth
    contains
    
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!时间三点平滑!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!
    !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!   
    SUBROUTINE three_smooth_time(ua, va, za, ub, vb, zb, uc, vc, zc, nx, ny, S_time)
    ! ua, va, za：前一时刻物理量
    ! ub, vb, zb：当前时刻物理量
    ! uc, vc, zc：下一时刻物理量
    ! nx, ny：网格数
    ! S_time：时间平滑系数
        IMPLICIT NONE
        INTEGER :: i, j
        INTEGER :: nx, ny
        REAL :: S_time
        REAL :: ua(nx, ny), va(nx, ny), za(nx, ny)
        REAL :: ub(nx, ny), vb(nx, ny), zb(nx, ny)
        REAL :: uc(nx, ny), vc(nx, ny), zc(nx, ny)
    
        do i = 2, nx - 1  !  边界不放在时间平滑里面
            do j = 2, ny - 1
                ub(i, j) = (1 - S_time) * ub(i, j) + S_time * (ua(i, j) + uc(i, j)) / 2.0
                vb(i, j) = (1 - S_time) * vb(i, j) + S_time * (va(i, j) + vc(i, j)) / 2.0
                zb(i, j) = (1 - S_time) * zb(i, j) + S_time * (za(i, j) + zc(i, j)) / 2.0
            enddo
        enddo
        return
    END SUBROUTINE three_smooth_time
    
END MODULE
